import{u as h,b as x,r as p,c as z,d,e as P,f as R,g as l,h as s,w as t,m as q,M as C,q as S,l as _,t as A}from"./index-e2b37a2a.js";import{u as U}from"./index-b3151ca4.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";const B={class:"register-container"},N={class:"register-header"},T={class:"brand"},F={class:"brand-logo rounded-md"},K={class:"register-footer"},M={__name:"Register",setup(D){const w=h();x();const a=p({username:"",email:"",password:"",confirmPassword:""}),f=p(null),r=p(!1),v=p(!1),b={username:[{required:!0,message:"请输入用户名"},{min:3,message:"用户名至少3个字符"}],password:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:i=>i===a.value.password,message:"两次密码不一致"}]},V=z(()=>a.value.username.length>=3&&a.value.password.length>=6&&a.value.password===a.value.confirmPassword),y=()=>{v.value=!0,setTimeout(()=>{v.value=!1},500)},g=async()=>{if(await f.value.validate()){r.value=!0;try{(await U.register({username:a.value.username,password:a.value.password,email:a.value.email||null})).data.success&&(C.success({content:"注册成功！正在跳转登录...",duration:2e3}),setTimeout(()=>{w.push({path:"/login",query:{username:a.value.username}})},1e3))}catch(e){console.error("注册失败:",e),y()}finally{r.value=!1}}};return(i,e)=>{const n=d("t-icon"),c=d("t-button"),u=d("t-input"),m=d("t-form-item"),k=d("t-form");return P(),R("div",B,[l("div",{class:q(["register-card app-card fade-in",{shake:v.value}])},[l("div",N,[l("div",T,[l("div",F,[s(n,{name:"user-add"})]),e[6]||(e[6]=l("div",{class:"brand-meta"},[l("h1",{class:"register-title"},"创建账号"),l("p",{class:"register-subtitle"},"注册 2FA Authenticator")],-1))]),s(c,{variant:"text",size:"small",onClick:e[0]||(e[0]=o=>i.$router.push("/login")),class:"switch-btn"},{default:t(()=>[s(n,{name:"login"}),e[7]||(e[7]=l("span",null,"已有账号？去登录",-1))]),_:1})]),s(k,{ref_key:"formRef",ref:f,data:a.value,rules:b,onSubmit:g},{default:t(()=>[s(m,{name:"username"},{default:t(()=>[s(u,{modelValue:a.value.username,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.username=o),size:"large",placeholder:"用户名（至少3个字符）",disabled:r.value},{"prefix-icon":t(()=>[s(n,{name:"user"})]),_:1},8,["modelValue","disabled"])]),_:1}),s(m,{name:"email"},{default:t(()=>[s(u,{modelValue:a.value.email,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.email=o),size:"large",type:"email",placeholder:"邮箱（可选）",disabled:r.value},{"prefix-icon":t(()=>[s(n,{name:"mail"})]),_:1},8,["modelValue","disabled"])]),_:1}),s(m,{name:"password"},{default:t(()=>[s(u,{modelValue:a.value.password,"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.password=o),size:"large",type:"password",placeholder:"密码（至少6个字符）",disabled:r.value},{"prefix-icon":t(()=>[s(n,{name:"lock-on"})]),_:1},8,["modelValue","disabled"])]),_:1}),s(m,{name:"confirmPassword"},{default:t(()=>[s(u,{modelValue:a.value.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.confirmPassword=o),size:"large",type:"password",placeholder:"确认密码",disabled:r.value,onKeyup:S(g,["enter"])},{"prefix-icon":t(()=>[s(n,{name:"lock-on"})]),_:1},8,["modelValue","disabled"])]),_:1}),s(c,{theme:"primary",size:"large",block:"",type:"submit",loading:r.value,disabled:!V.value,class:"register-button"},{default:t(()=>[_(A(r.value?"注册中...":"立即注册"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["data"]),l("div",K,[e[9]||(e[9]=l("span",null,"已有账号？",-1)),s(c,{variant:"text",size:"small",onClick:e[5]||(e[5]=o=>i.$router.push("/login"))},{default:t(()=>[...e[8]||(e[8]=[_("立即登录",-1)])]),_:1})])],2)])}}},G=$(M,[["__scopeId","data-v-8e138dba"]]);export{G as default};
