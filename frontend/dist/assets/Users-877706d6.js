import{c as e}from"./index-42d0e3ec.js";import{_ as a}from"./_plugin-vue_export-helper-1b428a4d.js";import{M as l}from"./ui-703c31fd.js";import{r as t,o as u,O as s,P as o,Q as d,Z as r,b as i,$ as n,E as m,_ as v,a0 as c}from"./vendor-d600c78b.js";import"./utils-783a0963.js";import"./index-64ce2276.js";const p={class:"users p-16"},_={class:"page-header"},f=a({__name:"Users",setup(a){const f=t([]),y=t(!1),b=t(""),h=t({}),V=[{colKey:"username",title:"用户名"},{colKey:"email",title:"邮箱"},{colKey:"role",title:"角色"},{colKey:"operation",title:"操作",width:200}],w=async()=>{try{const a=await e.getUsers();f.value=a.data.data}catch(a){}},U=()=>{b.value="添加用户",h.value={username:"",password:"",email:"",role:"user"},y.value=!0},j=async()=>{try{h.value.id?await e.updateUser(h.value.id,h.value):await e.createUser(h.value),l.success("操作成功"),w(),y.value=!1}catch(a){}};return u(()=>{w()}),(a,t)=>{const u=s("t-icon"),g=s("t-button"),k=s("t-space"),C=s("t-table"),x=s("t-input"),K=s("t-form-item"),z=s("t-option"),E=s("t-select"),I=s("t-form"),M=s("t-dialog");return o(),d("div",p,[r("div",_,[t[6]||(t[6]=r("h1",null,"用户管理",-1)),i(g,{theme:"primary",onClick:U},{icon:n(()=>[i(u,{name:"add"})]),default:n(()=>[t[5]||(t[5]=m(" 添加用户 ",-1))]),_:1})]),i(C,{data:f.value,columns:V,style:{"margin-top":"16px"},stripe:"",hover:""},{operation:n(({row:a})=>[i(k,null,{default:n(()=>[i(g,{size:"small",onClick:e=>{return l=a,b.value="编辑用户",h.value={...l},void(y.value=!0);var l}},{default:n(()=>[...t[7]||(t[7]=[m("编辑",-1)])]),_:1},8,["onClick"]),i(g,{size:"small",theme:"danger",onClick:t=>(async a=>{try{await e.deleteUser(a.id),l.success("删除成功"),w()}catch(t){}})(a)},{default:n(()=>[...t[8]||(t[8]=[m("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1},8,["data"]),i(M,{visible:y.value,"onUpdate:visible":t[4]||(t[4]=e=>y.value=e),header:b.value,onConfirm:j},{default:n(()=>[i(I,{data:h.value},{default:n(()=>[i(K,{label:"用户名"},{default:n(()=>[i(x,{modelValue:h.value.username,"onUpdate:modelValue":t[0]||(t[0]=e=>h.value.username=e)},null,8,["modelValue"])]),_:1}),h.value.id?c("",!0):(o(),v(K,{key:0,label:"密码"},{default:n(()=>[i(x,{modelValue:h.value.password,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value.password=e),type:"password"},null,8,["modelValue"])]),_:1})),i(K,{label:"邮箱"},{default:n(()=>[i(x,{modelValue:h.value.email,"onUpdate:modelValue":t[2]||(t[2]=e=>h.value.email=e)},null,8,["modelValue"])]),_:1}),i(K,{label:"角色"},{default:n(()=>[i(E,{modelValue:h.value.role,"onUpdate:modelValue":t[3]||(t[3]=e=>h.value.role=e)},{default:n(()=>[i(z,{value:"admin",label:"管理员"}),i(z,{value:"user",label:"普通用户"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}},[["__scopeId","data-v-92668658"]]);export{f as default};
