import{a as e}from"./utils-783a0963.js";import{u as t}from"./index-64ce2276.js";import{M as s}from"./ui-703c31fd.js";const a=e.create({baseURL:"/api",timeout:3e4});a.interceptors.request.use(e=>{const s=t();return s.sessionToken&&(e.headers["x-session-token"]=s.sessionToken),s.authToken&&(e.headers.Authorization=`Bearer ${s.authToken}`),e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,async e=>{var r;const o=t(),p=e.config;return!e.response&&p&&!p._retry&&(p._retry=(p._retry||0)+1,p._retry<=3)?(s.warning(`网络错误，正在重试（${p._retry}/3）...`),await new Promise(e=>setTimeout(e,1e3)),a(p)):(e.response?423===e.response.status?(o.lock(),s.warning("需要解锁才能继续操作")):401===e.response.status?(o.logout(),s.error("登录已过期")):(null==(r=e.response.data)?void 0:r.message)&&s.error(e.response.data.message):e.request?s.error("网络错误，请检查连接"):s.error("请求失败"),Promise.reject(e))});const r={register:e=>a.post("/users/register",e),login:e=>a.post("/users/login",e),getCurrentUser:()=>a.get("/users/me"),updateProfile:e=>a.put("/users/me",e),changePassword:e=>a.post("/users/change-password",e)},o={login:e=>a.post("/auth/login",e),checkMasterPassword:()=>a.get("/auth/check-master-password"),setMasterPassword:e=>a.post("/auth/set-master-password",e),unlock:e=>a.post("/auth/unlock",e),lock:()=>a.post("/auth/lock"),getPasswordHint:()=>a.get("/auth/password-hint"),changeMasterPassword:e=>a.post("/auth/change-master-password",e)},p={getAll:()=>a.get("/categories"),create:e=>a.post("/categories",e),update:(e,t)=>a.put(`/categories/${e}`,t),delete:e=>a.delete(`/categories/${e}`)},g={getAll:()=>a.get("/tags"),create:e=>a.post("/tags",e),update:(e,t)=>a.put(`/tags/${e}`,t),delete:e=>a.delete(`/tags/${e}`),getSecrets:e=>a.get(`/tags/${e}/secrets`)},i={getAll:e=>a.get("/secrets",{params:e}),getDetail:e=>a.get(`/secrets/${e}`),create:e=>a.post("/secrets",e),update:(e,t)=>a.put(`/secrets/${e}`,t),delete:e=>a.delete(`/secrets/${e}`),batchDelete:e=>a.post("/secrets/batch-delete",{ids:e}),batchUpdateCategory:(e,t)=>a.post("/secrets/batch-update-category",{ids:e,category_id:t}),updateSort:e=>a.post("/secrets/update-sort",{sortData:e}),toggleFavorite:e=>a.post(`/secrets/${e}/toggle-favorite`),togglePin:e=>a.post(`/secrets/${e}/toggle-pin`),getToken:e=>a.get(`/secrets/${e}/token`),getAllTokens:()=>a.get("/tokens")},n={upload:e=>a.post("/qrcode/upload",e),generate:e=>a.post("/qrcode/generate",e),parseUrl:e=>a.post("/qrcode/parse-url",e)},u={export:()=>a.get("/backup/export"),exportEncrypted:e=>a.post("/backup/export-encrypted",{password:e}),import:e=>a.post("/backup/import",e),history:()=>a.get("/backup/history"),autoBackup:()=>a.post("/backup/auto"),importGoogle:e=>a.post("/backup/import-google",{data:e})},c={getUsers:()=>a.get("/admin/users"),createUser:e=>a.post("/admin/users",e),updateUser:(e,t)=>a.put(`/admin/users/${e}`,t),deleteUser:e=>a.delete(`/admin/users/${e}`),getSettings:()=>a.get("/admin/settings"),updateSettings:e=>a.put("/admin/settings",{settings:e}),getStatistics:()=>a.get("/admin/statistics"),getUsageLogs:e=>a.get("/admin/usage-logs",{params:e}),cleanupSessions:()=>a.post("/admin/cleanup-sessions"),cleanupLogs:e=>a.post("/admin/cleanup-logs",{days:e}),optimizeDatabase:()=>a.post("/admin/optimize-database")},d={list:()=>a.get("/api-keys"),create:e=>a.post("/api-keys",e),update:(e,t)=>a.put(`/api-keys/${e}`,t),delete:e=>a.delete(`/api-keys/${e}`)};export{o as a,u as b,c,d,p as e,n as q,i as s,g as t,r as u};
