import{o as e,j as a,Y as l,r as t,c as s,O as n,P as i,Q as o,Z as r,b as c,_ as u,$ as d,a0 as v,a1 as m,F as p,a2 as f,E as h,a3 as y,R as g}from"./vendor-d600c78b.js";import{u as k}from"./index-64ce2276.js";import{s as b,q as w,b as x,u as _}from"./index-42d0e3ec.js";import{_ as C}from"./_plugin-vue_export-helper-1b428a4d.js";import{M as z,D}from"./ui-703c31fd.js";import"./utils-783a0963.js";const L={class:"home"},V={class:"header"},E={class:"header-container app-container"},U={class:"header-left"},j={class:"brand-logo"},F={class:"logo-icon"},A={class:"header-right"},I={class:"user-name"},T={class:"header-center"},O={key:0,class:"batch-toolbar"},R={class:"batch-toolbar-left"},S={class:"selected-count"},$={class:"batch-toolbar-right"},K={class:"main-content app-container"},P={key:0,class:"favorites-bar"},B={class:"favorites-header"},G={class:"favorites-list"},N=["onClick","title"],q={class:"favorite-info"},M={class:"favorite-name"},J={class:"favorite-token"},W={key:1,class:"empty-state"},H={class:"empty-icon"},Q={class:"empty-title"},Y={class:"empty-desc"},Z={key:3,class:"table-container desktop-view app-card"},X={class:"secret-table"},ee={key:0,class:"checkbox-col"},ae={key:0,class:"checkbox-cell"},le={class:"icon-cell"},te={class:"name-cell"},se={class:"name-wrapper"},ne={class:"secret-name"},ie={class:"issuer-cell"},oe={class:"issuer"},re={class:"note-cell"},ce=["title"],ue={class:"secret-key-cell"},de={class:"secret-key-wrapper"},ve={class:"secret-key-text"},me={class:"secret-key-actions"},pe={class:"code-cell"},fe=["onClick","title"],he={class:"timer-cell"},ye={class:"timer-wrapper"},ge={class:"timer-text"},ke={class:"action-cell"},be={key:1,style:{color:"#999"}},we={key:4,class:"mobile-view"},xe={class:"mobile-card-header"},_e={class:"mobile-card-title"},Ce={class:"mobile-name"},ze={class:"mobile-issuer"},De={key:0,class:"mobile-card-note"},Le={class:"mobile-note-text"},Ve={class:"mobile-card-secret"},Ee={class:"mobile-secret-value"},Ue={class:"mobile-secret-text"},je={class:"mobile-secret-actions"},Fe={class:"mobile-card-code"},Ae={class:"mobile-code-display"},Ie={class:"mobile-card-timer"},Te={class:"mobile-timer-text"},Oe={key:5,class:"footer-stats"},Re={class:"stat-item"},Se={key:0,class:"stat-item"},$e={class:"stat-item"},Ke={style:{"text-align":"center"}},Pe={key:0,style:{"margin-bottom":"16px"}},Be=["src"],Ge=C({__name:"Home",setup(C){const Ge=l(),Ne=k(),qe=t(null),Me=t(window.innerWidth<=768),Je=()=>{Me.value=window.innerWidth<=768},We=t(!1),He=t([]),Qe=t({}),Ye=t(30),Ze=t(""),Xe=t([]),ea=t(!1),aa=t([]),la=t(null),ta=s(()=>He.value.filter(e=>e.is_favorite).slice(0,5)),sa=t(!1),na=t("添加密钥"),ia=t({name:"",secret_key:"",issuer:"",note:""}),oa=t(!1),ra=t("merge"),ca=t(null),ua=[{content:"导出数据",value:"export"},{content:"导入数据",value:"import"},{content:"API 密钥",value:"api-keys"},{content:"主题定制",value:"theme"},{content:"设置",value:"settings"}],da=s(()=>{var e;const a=[{content:"个人资料",value:"profile",prefixIcon:"user"},{content:"修改密码",value:"change-password",prefixIcon:"lock-on"}];return"admin"===(null==(e=qe.value)?void 0:e.role)&&(a.push({content:"管理后台",value:"admin",prefixIcon:"dashboard"}),a.push({content:"API 密钥",value:"api-keys",prefixIcon:"key"})),a.push({content:"主题定制",value:"theme",prefixIcon:"palette"}),a.push({content:"退出登录",value:"logout",prefixIcon:"poweroff",theme:"danger"}),a}),va=e=>[{content:"编辑",value:"edit"},{content:e.is_favorite?"取消收藏":"收藏",value:"favorite"},{content:"删除",value:"delete",theme:"danger"}],ma=s({get:()=>Xe.value.length===fa.value.length&&fa.value.length>0,set:e=>{Xe.value=e?fa.value.map(e=>e.id):[]}}),pa=s(()=>Ye.value/30*100),fa=s(()=>{let e=He.value;if(Ze.value){const a=Ze.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(a)||e.issuer&&e.issuer.toLowerCase().includes(a)||e.note&&e.note.toLowerCase().includes(a))}return e.sort((e,a)=>e.is_favorite&&!a.is_favorite?-1:!e.is_favorite&&a.is_favorite?1:0)}),ha={github:"🔵",google:"🔴",microsoft:"🟢",apple:"⚫",facebook:"🔵",twitter:"🔵",amazon:"🟠",aws:"🟠",azure:"🔵",steam:"⚫",discord:"🟣",telegram:"🔵",dropbox:"🔵",gitlab:"🟠",default:"🔐"},ya={github:"#181717",google:"#4285F4",microsoft:"#00A4EF",apple:"#000000",facebook:"#1877F2",twitter:"#1DA1F2",amazon:"#FF9900",aws:"#FF9900",azure:"#0078D4",steam:"#171A21",discord:"#5865F2",telegram:"#26A5E4",dropbox:"#0061FF",gitlab:"#FC6D26",default:"#1890ff"},ga=e=>{const a=(e.name+" "+(e.issuer||"")).toLowerCase();for(const[l,t]of Object.entries(ha))if(a.includes(l))return t;return ha.default},ka=e=>{const a=(e.name+" "+(e.issuer||"")).toLowerCase();for(const[l,t]of Object.entries(ya))if(a.includes(l))return t;return ya.default},ba=async()=>{We.value=!0;try{const e=await b.getAll();if(!Array.isArray(e.data.data))throw new Error("数据格式错误");const a=e.data.data.filter(e=>!!(e.id&&e.name&&e.secret_key));a.length<e.data.data.length&&z.warning(`发现 ${e.data.data.length-a.length} 个无效密钥已被过滤`),He.value=a}catch(e){z.error("加载失败："+e.message)}finally{We.value=!1}},wa=async()=>{var e;try{const a=await b.getAllTokens(),l={};a.data.data.forEach(e=>{l[e.id]=e.token}),Qe.value=l,Ye.value=(null==(e=a.data.data[0])?void 0:e.remaining)||30}catch(a){}},xa=e=>Qe.value[e]||"------",_a=e=>"------"===e?e:e.slice(0,3)+" "+e.slice(3),Ca=async e=>{const a=Qe.value[e];if(a&&"------"!==a)try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a),z.success("验证码已复制（30秒后自动清除）");else{const e=document.createElement("textarea");e.value=a,e.style.position="fixed",e.style.opacity="0",document.body.appendChild(e),e.select();try{if(!document.execCommand("copy"))throw new Error("复制命令执行失败");z.success("验证码已复制（30秒后自动清除）")}finally{document.body.removeChild(e)}}la.value=e,setTimeout(()=>{la.value=null},1e3),setTimeout(async()=>{try{if(navigator.clipboard&&navigator.clipboard.readText){await navigator.clipboard.readText()===a&&await navigator.clipboard.writeText("")}}catch(e){}},3e4)}catch(l){z.error("复制失败："+l.message)}else z.warning("验证码还未生成，请稍候")},za=()=>{na.value="添加密钥",ia.value={name:"",secret_key:"",issuer:"",note:""},sa.value=!0},Da=t(!1),La=t(""),Va=t(null),Ea=t(!1),Ua=()=>{Da.value=!0,La.value="",setTimeout(()=>{document.addEventListener("paste",Ra)},100)},ja=()=>{document.removeEventListener("paste",Ra)},Fa=()=>{var e;null==(e=Va.value)||e.click()},Aa=e=>{const a=e.target.files[0];a&&Sa(a)},Ia=e=>{e.preventDefault(),Ea.value=!0},Ta=e=>{e.preventDefault(),Ea.value=!1},Oa=e=>{e.preventDefault(),Ea.value=!1;const a=e.dataTransfer.files[0];a&&a.type.startsWith("image/")?Sa(a):z.warning("请拖拽图片文件")},Ra=e=>{var a;if(!Da.value)return;const l=null==(a=e.clipboardData)?void 0:a.items;if(l)for(let t=0;t<l.length;t++)if(l[t].type.startsWith("image/")){const a=l[t].getAsFile();Sa(a),e.preventDefault();break}},Sa=e=>{if(!e)return;if(!e.type.startsWith("image/"))return void z.error("请上传图片文件（JPG、PNG 等格式）");if(e.size>10485760)return void z.error("图片文件过大，请选择小于 10MB 的图片");const a=new FileReader;a.onload=async e=>{var a,l;try{La.value=e.target.result;const a=z.loading({content:"正在识别二维码，请稍候...",duration:0}),l=await w.upload({image:e.target.result});if(a.close(),l.data.success){const e=l.data.data;if(!e.secret)return void z.error("二维码数据不完整，缺少密钥信息");ia.value={name:e.name||e.issuer||"未命名",secret_key:e.secret,issuer:e.issuer||"",note:""},z.success({content:"✓ 二维码识别成功！",duration:2e3}),Da.value=!1,sa.value=!0,ja()}}catch(t){z.close();const e=(null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.message)||t.message;e.includes("未能识别")||e.includes("未找到")?z.error({content:"❌ 未能识别到二维码\n\n💡 请确保：\n• 图片清晰完整\n• 包含完整的二维码\n• 光线充足、无反光\n• 尝试放大后截图",duration:5e3}):e.includes("otpauth")?z.error({content:"❌ 二维码格式不正确\n\n💡 请使用：\n• Google Authenticator\n• Microsoft Authenticator\n• 其他标准 TOTP 应用的二维码",duration:5e3}):z.error({content:"二维码解析失败\n\n原因："+e,duration:4e3})}},a.onerror=()=>{z.error("图片读取失败，请确保文件未损坏")},a.readAsDataURL(e)},$a=async()=>{var e,a;if(ia.value.name&&ia.value.secret_key)try{ia.value.id?(await b.update(ia.value.id,ia.value),z.success("更新成功")):(await b.create(ia.value),z.success("添加成功")),ba(),wa(),sa.value=!1}catch(l){z.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||"操作失败")}else z.warning("请填写名称和密钥")},Ka=async(e,a)=>{switch(e.value){case"edit":na.value="编辑密钥",ia.value={...a},sa.value=!0;break;case"favorite":try{await b.toggleFavorite(a.id),ba(),z.success(a.is_favorite?"已取消收藏":"已收藏")}catch(l){z.error("操作失败")}break;case"delete":try{await b.delete(a.id),z.success("删除成功"),ba()}catch(l){z.error("删除失败")}}},Pa=async e=>{switch(e.value){case"export":try{const e=await x.export(),a=new Blob([JSON.stringify(e.data.data,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),t=document.createElement("a");t.href=l,t.download=`2fa-backup-${Date.now()}.json`,t.click(),URL.revokeObjectURL(l),localStorage.setItem("last_backup_time",Date.now().toString()),z.success("导出成功")}catch(a){z.error("导出失败")}break;case"import":oa.value=!0;break;case"api-keys":Ge.push("/api-keys");break;case"theme":Ge.push("/theme");break;case"settings":Ge.push("/settings")}},Ba=()=>{Ne.lock(),Ge.push("/unlock")},Ga=async e=>{switch(e.value){case"profile":case"change-password":Ge.push("/profile");break;case"admin":Ge.push("/admin");break;case"api-keys":Ge.push("/api-keys");break;case"theme":Ge.push("/theme");break;case"logout":await D.confirm({header:"退出登录",body:"确定要退出登录吗？",confirmBtn:"退出",cancelBtn:"取消"})&&(Ne.logout(),z.success("已退出登录"),Ge.push("/login"))}},Na=e=>{const a=aa.value.indexOf(e);a>-1?aa.value.splice(a,1):aa.value.push(e)},qa=async e=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(e),z.success("密钥已复制到剪贴板");else{const a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.opacity="0",document.body.appendChild(a),a.select();try{if(!document.execCommand("copy"))throw new Error("复制命令执行失败");z.success("密钥已复制到剪贴板")}finally{document.body.removeChild(a)}}}catch(a){z.error("复制失败："+a.message)}},Ma=()=>{ea.value=!0,Xe.value=[]},Ja=()=>{ea.value=!1,Xe.value=[]},Wa=e=>{const a=Xe.value.indexOf(e);a>-1?Xe.value.splice(a,1):Xe.value.push(e)},Ha=e=>{Xe.value=e?fa.value.map(e=>e.id):[]},Qa=async()=>{var e,a;if(0===Xe.value.length)return void z.warning("请先选择要删除的密钥");if(confirm(`确定要删除选中的 ${Xe.value.length} 个密钥吗？此操作不可恢复！`))try{await b.batchDelete(Xe.value),z.success(`成功删除 ${Xe.value.length} 个密钥`),ba(),wa(),Ja()}catch(l){z.error("批量删除失败："+((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.message)||l.message))}},Ya=()=>{if(0!==Xe.value.length)try{const e=He.value.filter(e=>Xe.value.includes(e.id)),a={version:"2.0.0",timestamp:(new Date).toISOString(),count:e.length,secrets:e},l=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),t=URL.createObjectURL(l),s=document.createElement("a");s.href=t,s.download=`2fa-selected-${e.length}-${Date.now()}.json`,s.click(),URL.revokeObjectURL(t),z.success(`成功导出 ${e.length} 个密钥`)}catch(e){z.error("导出失败："+e.message)}else z.warning("请先选择要导出的密钥")},Za=e=>{ca.value=e.target.files[0]},Xa=async()=>{if(ca.value)try{const e=await ca.value.text(),a=JSON.parse(e);await x.import({categories:a.categories,secrets:a.secrets,merge:"merge"===ra.value}),z.success("导入成功"),ba(),wa(),oa.value=!1}catch(e){z.error("导入失败："+e.message)}else z.warning("请选择文件")};!function(l){const t=e=>{var a,t,s,n,i,o;if((e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),null==(a=l.onSearch)||a.call(l)),(e.ctrlKey||e.metaKey)&&"n"===e.key&&(e.preventDefault(),null==(t=l.onNew)||t.call(l)),(e.ctrlKey||e.metaKey)&&"s"===e.key&&(e.preventDefault(),null==(s=l.onSave)||s.call(l)),(e.ctrlKey||e.metaKey)&&"l"===e.key&&(e.preventDefault(),null==(n=l.onLock)||n.call(l)),"Escape"===e.key&&(null==(i=l.onEscape)||i.call(l)),/^[1-9]$/.test(e.key)&&(e.ctrlKey||e.metaKey)){e.preventDefault();const a=parseInt(e.key)-1;null==(o=l.onQuickCopy)||o.call(l,a)}};e(()=>{document.addEventListener("keydown",t)}),a(()=>{document.removeEventListener("keydown",t)})}({onSearch:()=>{var e;return null==(e=document.querySelector(".search-input input"))?void 0:e.focus()},onNew:za,onLock:Ba});let el=null;return e(()=>{ba(),wa(),(async()=>{if(Ne.authToken)try{const e=await _.getCurrentUser();e.data.success&&(qe.value=e.data.data)}catch(e){}})(),(()=>{const e=localStorage.getItem("last_backup_time");if(!e)return;const a=(Date.now()-parseInt(e))/864e5;a>7&&setTimeout(()=>{z.warning({content:`您已经 ${Math.floor(a)} 天没有备份数据了，建议立即备份`,duration:8e3})},2e3)})(),el=setInterval(()=>{Ye.value--,Ye.value<=0&&wa()},1e3),window.addEventListener("resize",Je)}),a(()=>{el&&clearInterval(el),window.removeEventListener("resize",Je),document.removeEventListener("paste",Ra)}),(e,a)=>{const l=n("t-icon"),t=n("t-button"),s=n("t-dropdown"),k=n("t-input"),b=n("t-checkbox"),w=n("t-space"),x=n("t-loading"),_=n("t-progress"),C=n("t-form-item"),z=n("t-textarea"),D=n("t-form"),Ge=n("t-dialog"),Ne=n("t-radio"),Je=n("t-radio-group");return i(),o("div",L,[r("div",V,[r("div",E,[r("div",U,[r("div",j,[r("div",F,[c(l,{name:"secured",size:"22px"})]),a[11]||(a[11]=r("div",{class:"brand-info"},[r("span",{class:"brand-name"},"2FA Authenticator")],-1))])]),r("div",A,[ea.value?v("",!0):(i(),u(t,{key:0,theme:"primary",onClick:za,class:"action-btn"},{icon:d(()=>[c(l,{name:"add"})]),default:d(()=>[a[12]||(a[12]=r("span",{class:"btn-text"},"新建",-1))]),_:1})),!ea.value&&fa.value.length>0?(i(),u(t,{key:1,variant:"outline",onClick:Ma,class:"action-btn"},{icon:d(()=>[c(l,{name:"check-circle"})]),default:d(()=>[a[13]||(a[13]=r("span",{class:"btn-text"},"批量",-1))]),_:1})):v("",!0),ea.value?(i(),u(t,{key:2,theme:"danger",onClick:Ja,class:"action-btn exit-batch-btn"},{default:d(()=>[a[14]||(a[14]=r("span",{class:"btn-text"},"退出批量",-1)),c(l,{name:"close",class:"btn-icon-only"})]),_:1})):v("",!0),ea.value?v("",!0):(i(),u(s,{key:3,options:ua,onClick:Pa},{default:d(()=>[c(t,{variant:"outline",shape:"circle",class:"icon-btn"},{default:d(()=>[c(l,{name:"ellipsis"})]),_:1})]),_:1})),!ea.value&&qe.value?(i(),u(s,{key:4,options:da.value,onClick:Ga},{default:d(()=>[c(t,{variant:"outline",class:"user-btn"},{default:d(()=>[c(l,{name:"user"}),r("span",I,m(qe.value.username),1)]),_:1})]),_:1},8,["options"])):v("",!0),ea.value?v("",!0):(i(),u(t,{key:5,variant:"outline",shape:"circle",onClick:Ba,class:"icon-btn"},{default:d(()=>[c(l,{name:"lock-on"})]),_:1}))]),r("div",T,[c(k,{modelValue:Ze.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Ze.value=e),placeholder:Me.value?"搜索...":"搜索密钥、发行商...",class:"search-input",clearable:""},{"prefix-icon":d(()=>[c(l,{name:"search"})]),_:1},8,["modelValue","placeholder"])])])]),ea.value&&fa.value.length>0?(i(),o("div",O,[r("div",R,[c(b,{modelValue:ma.value,"onUpdate:modelValue":a[1]||(a[1]=e=>ma.value=e),onChange:Ha},{default:d(()=>[...a[15]||(a[15]=[h(" 全选 ",-1)])]),_:1},8,["modelValue"]),r("span",S,"已选择 "+m(Xe.value.length)+" 项",1)]),r("div",$,[c(t,{theme:"primary",variant:"outline",disabled:0===Xe.value.length,onClick:Ya},{icon:d(()=>[c(l,{name:"download"})]),default:d(()=>[a[16]||(a[16]=h(" 导出选中 ",-1))]),_:1},8,["disabled"]),c(t,{theme:"danger",disabled:0===Xe.value.length,onClick:Qa},{icon:d(()=>[c(l,{name:"delete"})]),default:d(()=>[a[17]||(a[17]=h(" 删除选中 ",-1))]),_:1},8,["disabled"])])])):v("",!0),r("div",K,[!We.value&&ta.value.length>0?(i(),o("div",P,[r("div",B,[c(l,{name:"star-filled",style:{color:"#faad14","margin-right":"8px"}}),a[18]||(a[18]=r("span",{class:"favorites-title"},"常用密钥",-1))]),r("div",G,[(i(!0),o(p,null,f(ta.value,e=>(i(),o("div",{key:e.id,class:"favorite-item",onClick:a=>Ca(e.id),title:`点击复制 ${e.name} 的验证码`},[r("div",{class:"favorite-icon",style:y({backgroundColor:ka(e)})},m(ga(e)),5),r("div",q,[r("div",M,m(e.name),1),r("div",J,m(_a(xa(e.id))),1)])],8,N))),128))])])):v("",!0),We.value||0!==fa.value.length?We.value?(i(),u(x,{key:2,size:"large",text:"加载中..."})):(i(),o("div",Z,[r("table",X,[r("thead",null,[r("tr",null,[ea.value?(i(),o("th",ee)):v("",!0),a[21]||(a[21]=r("th",{class:"icon-col"},null,-1)),a[22]||(a[22]=r("th",{class:"name-col"},"服务/名称",-1)),a[23]||(a[23]=r("th",{class:"issuer-col"},"发行者",-1)),a[24]||(a[24]=r("th",{class:"note-col"},"备注",-1)),a[25]||(a[25]=r("th",{class:"key-col"},"密钥",-1)),a[26]||(a[26]=r("th",{class:"code-col"},"验证码",-1)),a[27]||(a[27]=r("th",{class:"timer-col"},"剩余时间",-1)),a[28]||(a[28]=r("th",{class:"action-col"},"操作",-1))])]),r("tbody",null,[(i(!0),o(p,null,f(fa.value,e=>(i(),o("tr",{key:e.id,class:g(["secret-row",{"selected-row":Xe.value.includes(e.id)}])},[ea.value?(i(),o("td",ae,[c(b,{checked:Xe.value.includes(e.id),onChange:a=>Wa(e.id)},null,8,["checked","onChange"])])):v("",!0),r("td",le,[r("div",{class:"service-icon",style:y({backgroundColor:ka(e)})},m(ga(e)),5)]),r("td",te,[r("div",se,[r("span",ne,m(e.name),1),e.is_favorite?(i(),u(l,{key:0,name:"star-filled",style:{color:"#faad14","margin-left":"8px"}})):v("",!0)])]),r("td",ie,[r("span",oe,m(e.issuer||"-"),1)]),r("td",re,[r("span",{class:"note-text",title:e.note},m(e.note||"-"),9,ce)]),r("td",ue,[r("div",de,[r("span",ve,m(aa.value.includes(e.id)?e.secret_key:"••••••••••••••••"),1),r("div",me,[c(t,{size:"small",variant:"text",onClick:a=>Na(e.id),title:aa.value.includes(e.id)?"隐藏密钥":"显示密钥"},{default:d(()=>[c(l,{name:aa.value.includes(e.id)?"browse-off":"browse"},null,8,["name"])]),_:2},1032,["onClick","title"]),c(t,{size:"small",variant:"text",onClick:a=>qa(e.secret_key),title:"复制密钥"},{default:d(()=>[c(l,{name:"file-copy"})]),_:1},8,["onClick"])])])]),r("td",pe,[r("div",{class:g(["code-display",{"code-expiring":Ye.value<=5,"copied-animation":la.value===e.id}]),onClick:a=>Ca(e.id),title:Ye.value<=5?"验证码即将过期！":"点击复制验证码"},m(_a(xa(e.id))),11,fe)]),r("td",he,[r("div",ye,[c(_,{percentage:pa.value,"stroke-width":6,theme:pa.value>30?"success":"warning","show-label":!1,style:{width:"100px","margin-right":"8px"}},null,8,["percentage","theme"]),r("span",ge,m(Ye.value)+"s",1)])]),r("td",ke,[ea.value?(i(),o("span",be,"批量模式")):(i(),u(w,{key:0,size:"small"},{default:d(()=>[c(t,{size:"small",theme:"primary",variant:"outline",onClick:a=>Ca(e.id)},{default:d(()=>[c(l,{name:"file-copy"})]),_:1},8,["onClick"]),c(s,{options:va(e),onClick:a=>Ka(a,e)},{default:d(()=>[c(t,{size:"small",variant:"outline"},{default:d(()=>[c(l,{name:"more"})]),_:1})]),_:1},8,["options","onClick"])]),_:2},1024))])],2))),128))])])])):(i(),o("div",W,[r("div",H,[c(l,{name:"secured",size:"80px"})]),r("h3",Q,m(Ze.value?"没有找到匹配的密钥":"开始使用 2FA 笔记本"),1),r("p",Y,m(Ze.value?"试试其他搜索关键词":"添加您的第一个两步验证密钥，保护账户安全"),1),Ze.value?v("",!0):(i(),u(w,{key:0,direction:"vertical",size:"large"},{default:d(()=>[c(t,{theme:"primary",size:"large",onClick:za},{icon:d(()=>[c(l,{name:"add"})]),default:d(()=>[a[19]||(a[19]=h(" 添加密钥 ",-1))]),_:1}),c(t,{variant:"text",size:"large",onClick:a[2]||(a[2]=e=>Pa({value:"import"}))},{default:d(()=>[...a[20]||(a[20]=[h(" 或导入现有数据 ",-1)])]),_:1})]),_:1}))])),!We.value&&fa.value.length>0?(i(),o("div",we,[(i(!0),o(p,null,f(fa.value,e=>(i(),o("div",{key:e.id,class:g(["mobile-card",{"selected-card":Xe.value.includes(e.id)}])},[r("div",xe,[ea.value?(i(),u(b,{key:0,checked:Xe.value.includes(e.id),onChange:a=>Wa(e.id),style:{"margin-right":"12px"}},null,8,["checked","onChange"])):v("",!0),r("div",_e,[r("div",{class:"service-icon-mobile",style:y({backgroundColor:ka(e)})},m(ga(e)),5),r("div",null,[r("div",Ce,[h(m(e.name)+" ",1),e.is_favorite?(i(),u(l,{key:0,name:"star-filled",style:{color:"#faad14","margin-left":"4px"},size:"14px"})):v("",!0)]),r("div",ze,m(e.issuer||"未设置发行者"),1)])]),c(s,{options:va(e),onClick:a=>Ka(a,e)},{default:d(()=>[c(t,{size:"small",variant:"text"},{default:d(()=>[c(l,{name:"more",size:"20px"})]),_:1})]),_:1},8,["options","onClick"])]),e.note?(i(),o("div",De,[c(l,{name:"chat",size:"14px",style:{color:"#999","margin-right":"4px"}}),r("span",Le,m(e.note),1)])):v("",!0),r("div",Ve,[a[29]||(a[29]=r("div",{class:"mobile-secret-label"},"密钥",-1)),r("div",Ee,[r("span",Ue,m(aa.value.includes(e.id)?e.secret_key:"••••••••••••••••"),1),r("div",je,[c(t,{size:"small",variant:"text",onClick:a=>Na(e.id)},{default:d(()=>[c(l,{name:aa.value.includes(e.id)?"browse-off":"browse"},null,8,["name"])]),_:2},1032,["onClick"]),c(t,{size:"small",variant:"text",onClick:a=>qa(e.secret_key)},{default:d(()=>[c(l,{name:"file-copy"})]),_:1},8,["onClick"])])])]),r("div",Fe,[r("div",Ae,m(_a(xa(e.id))),1),c(t,{theme:"primary",size:"large",block:"",onClick:a=>Ca(e.id)},{icon:d(()=>[c(l,{name:"file-copy"})]),default:d(()=>[a[30]||(a[30]=h(" 复制验证码 ",-1))]),_:1},8,["onClick"])]),r("div",Ie,[c(_,{percentage:pa.value,"stroke-width":4,theme:pa.value>30?"success":"warning","show-label":!1},null,8,["percentage","theme"]),r("span",Te,m(Ye.value)+" 秒后刷新",1)])],2))),128))])):v("",!0),!We.value&&fa.value.length>0?(i(),o("div",Oe,[r("div",Re,[c(l,{name:"key",size:"16px"}),r("span",null,"总计 "+m(He.value.length)+" 个密钥",1)]),Ze.value?(i(),o("div",Se,[c(l,{name:"search",size:"16px"}),r("span",null,"筛选 "+m(fa.value.length)+" 个",1)])):v("",!0),r("div",$e,[c(l,{name:"refresh",size:"16px"}),r("span",null,m(Ye.value)+"秒后刷新",1)])])):v("",!0)]),c(Ge,{visible:sa.value,"onUpdate:visible":a[7]||(a[7]=e=>sa.value=e),header:na.value,width:Me.value?"92%":"600px",onConfirm:$a},{default:d(()=>[c(D,{data:ia.value,"label-width":"80px"},{default:d(()=>[c(C,{label:"名称",required:""},{default:d(()=>[c(k,{modelValue:ia.value.name,"onUpdate:modelValue":a[3]||(a[3]=e=>ia.value.name=e),placeholder:"例如：GitHub"},null,8,["modelValue"])]),_:1}),c(C,{label:"密钥",required:""},{tips:d(()=>[c(w,{direction:"vertical",size:"4px"},{default:d(()=>[a[32]||(a[32]=r("span",null,"从服务商获取的密钥字符串",-1)),c(t,{size:"small",theme:"primary",variant:"text",onClick:Ua},{default:d(()=>[...a[31]||(a[31]=[h(" 或者上传二维码图片 ",-1)])]),_:1})]),_:1})]),default:d(()=>[c(k,{modelValue:ia.value.secret_key,"onUpdate:modelValue":a[4]||(a[4]=e=>ia.value.secret_key=e),placeholder:"Base32 格式密钥"},null,8,["modelValue"])]),_:1}),c(C,{label:"发行者"},{default:d(()=>[c(k,{modelValue:ia.value.issuer,"onUpdate:modelValue":a[5]||(a[5]=e=>ia.value.issuer=e),placeholder:"例如：github.com"},null,8,["modelValue"])]),_:1}),c(C,{label:"备注"},{default:d(()=>[c(z,{modelValue:ia.value.note,"onUpdate:modelValue":a[6]||(a[6]=e=>ia.value.note=e),placeholder:"添加备注信息（可选）",autosize:{minRows:2,maxRows:4}},null,8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header","width"]),c(Ge,{visible:oa.value,"onUpdate:visible":a[9]||(a[9]=e=>oa.value=e),header:"导入数据",width:Me.value?"92%":"500px",onConfirm:Xa},{default:d(()=>[c(D,null,{default:d(()=>[c(C,{label:"导入模式"},{default:d(()=>[c(Je,{modelValue:ra.value,"onUpdate:modelValue":a[8]||(a[8]=e=>ra.value=e)},{default:d(()=>[c(Ne,{value:"merge"},{default:d(()=>[...a[33]||(a[33]=[h("合并到现有数据",-1)])]),_:1}),c(Ne,{value:"replace"},{default:d(()=>[...a[34]||(a[34]=[h("替换现有数据",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),c(C,{label:"选择文件"},{default:d(()=>[r("input",{type:"file",accept:".json",onChange:Za,ref_key:"fileInputRef",ref:ca},null,544)]),_:1})]),_:1})]),_:1},8,["visible","width"]),c(Ge,{visible:Da.value,"onUpdate:visible":a[10]||(a[10]=e=>Da.value=e),header:"扫描二维码",width:Me.value?"92%":"500px",footer:!1,onClose:ja},{default:d(()=>[r("div",Ke,[La.value?(i(),o("div",Pe,[r("img",{src:La.value,style:{"max-width":"100%","max-height":"300px","border-radius":"8px"}},null,8,Be)])):v("",!0),r("div",{class:g(["qr-upload-zone",{dragging:Ea.value}]),onDrop:Oa,onDragover:Ia,onDragleave:Ta,onClick:Fa},[c(l,{name:"cloud-upload",size:"48px",style:{color:"#0052d9","margin-bottom":"16px"}}),a[35]||(a[35]=r("div",{class:"upload-text-primary"}," 📤 点击选择 / 拖拽图片 / Ctrl+V 粘贴 ",-1)),a[36]||(a[36]=r("div",{class:"upload-text-secondary"}," 支持 JPG、PNG 格式，最大 10MB ",-1)),a[37]||(a[37]=r("div",{class:"upload-tips"},[r("div",{class:"tip-item"},"💡 确保图片清晰完整"),r("div",{class:"tip-item"},"💡 包含完整的二维码区域"),r("div",{class:"tip-item"},"💡 支持 Google / Microsoft Authenticator 等标准格式")],-1)),r("input",{ref_key:"qrFileInput",ref:Va,type:"file",accept:"image/*",style:{display:"none"},onChange:Aa},null,544)],34),a[38]||(a[38]=r("div",{style:{"margin-top":"16px",color:"#999","font-size":"13px","text-align":"left"}},[r("p",null,[r("strong",null,"使用方法：")]),r("p",null,"• 点击上方区域选择图片"),r("p",null,"• 拖拽图片到上方区域"),r("p",null,"• 复制图片后按 Ctrl+V 粘贴"),r("p",null,"• 系统将自动解析二维码并填充密钥")],-1))])]),_:1},8,["visible","width"])])}}},[["__scopeId","data-v-5d3b5f94"]]);export{Ge as default};
