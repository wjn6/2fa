import{Y as e,r as a,c as s,O as l,P as r,Q as i,Z as d,b as o,$ as u,R as t,a5 as n,E as m,a1 as p}from"./vendor-d600c78b.js";import{u as c}from"./index-42d0e3ec.js";import{u as v}from"./index-64ce2276.js";import{_ as f}from"./_plugin-vue_export-helper-1b428a4d.js";import{M as g}from"./ui-703c31fd.js";import"./utils-783a0963.js";const b={class:"register-container"},w={class:"register-header"},_={class:"brand"},h={class:"brand-logo rounded-md"},V={class:"register-footer"},y=f({__name:"Register",setup(f){const y=e();v();const x=a({username:"",email:"",password:"",confirmPassword:""}),j=a(null),k=a(!1),z=a(!1),P={username:[{required:!0,message:"请输入用户名"},{min:3,message:"用户名至少3个字符"}],password:[{required:!0,message:"请输入密码"},{min:6,message:"密码至少6个字符"}],confirmPassword:[{required:!0,message:"请确认密码"},{validator:e=>e===x.value.password,message:"两次密码不一致"}]},q=s(()=>x.value.username.length>=3&&x.value.password.length>=6&&x.value.password===x.value.confirmPassword),U=async()=>{if(await j.value.validate()){k.value=!0;try{(await c.register({username:x.value.username,password:x.value.password,email:x.value.email||null})).data.success&&(g.success({content:"注册成功！正在跳转登录...",duration:2e3}),setTimeout(()=>{y.push({path:"/login",query:{username:x.value.username}})},1e3))}catch(e){z.value=!0,setTimeout(()=>{z.value=!1},500)}finally{k.value=!1}}};return(e,a)=>{const s=l("t-icon"),c=l("t-button"),v=l("t-input"),f=l("t-form-item"),g=l("t-form");return r(),i("div",b,[d("div",{class:t(["register-card app-card fade-in",{shake:z.value}])},[d("div",w,[d("div",_,[d("div",h,[o(s,{name:"user-add"})]),a[6]||(a[6]=d("div",{class:"brand-meta"},[d("h1",{class:"register-title"},"创建账号"),d("p",{class:"register-subtitle"},"注册 2FA Authenticator")],-1))]),o(c,{variant:"text",size:"small",onClick:a[0]||(a[0]=a=>e.$router.push("/login")),class:"switch-btn"},{default:u(()=>[o(s,{name:"login"}),a[7]||(a[7]=d("span",null,"已有账号？去登录",-1))]),_:1})]),o(g,{ref_key:"formRef",ref:j,data:x.value,rules:P,onSubmit:U},{default:u(()=>[o(f,{name:"username"},{default:u(()=>[o(v,{modelValue:x.value.username,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.username=e),size:"large",placeholder:"用户名（至少3个字符）",disabled:k.value},{"prefix-icon":u(()=>[o(s,{name:"user"})]),_:1},8,["modelValue","disabled"])]),_:1}),o(f,{name:"email"},{default:u(()=>[o(v,{modelValue:x.value.email,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value.email=e),size:"large",type:"email",placeholder:"邮箱（可选）",disabled:k.value},{"prefix-icon":u(()=>[o(s,{name:"mail"})]),_:1},8,["modelValue","disabled"])]),_:1}),o(f,{name:"password"},{default:u(()=>[o(v,{modelValue:x.value.password,"onUpdate:modelValue":a[3]||(a[3]=e=>x.value.password=e),size:"large",type:"password",placeholder:"密码（至少6个字符）",disabled:k.value},{"prefix-icon":u(()=>[o(s,{name:"lock-on"})]),_:1},8,["modelValue","disabled"])]),_:1}),o(f,{name:"confirmPassword"},{default:u(()=>[o(v,{modelValue:x.value.confirmPassword,"onUpdate:modelValue":a[4]||(a[4]=e=>x.value.confirmPassword=e),size:"large",type:"password",placeholder:"确认密码",disabled:k.value,onKeyup:n(U,["enter"])},{"prefix-icon":u(()=>[o(s,{name:"lock-on"})]),_:1},8,["modelValue","disabled"])]),_:1}),o(c,{theme:"primary",size:"large",block:"",type:"submit",loading:k.value,disabled:!q.value,class:"register-button"},{default:u(()=>[m(p(k.value?"注册中...":"立即注册"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["data"]),d("div",V,[a[9]||(a[9]=d("span",null,"已有账号？",-1)),o(c,{variant:"text",size:"small",onClick:a[5]||(a[5]=a=>e.$router.push("/login"))},{default:u(()=>[...a[8]||(a[8]=[m("立即登录",-1)])]),_:1})])],2)])}}},[["__scopeId","data-v-8638fa1b"]]);export{y as default};
