import{c as d}from"./index-b3151ca4.js";import{_ as $}from"./_plugin-vue_export-helper-c27b6911.js";import{r as i,o as j,d as n,e as y,f as D,g as b,h as t,w as l,M as U,l as v,i as E,j as I}from"./index-e2b37a2a.js";const P={class:"users p-16"},S={class:"page-header"},h={__name:"Users",setup(q){const f=i([]),r=i(!1),m=i(""),o=i({}),g=[{colKey:"username",title:"用户名"},{colKey:"email",title:"邮箱"},{colKey:"role",title:"角色"},{colKey:"operation",title:"操作",width:200}],c=async()=>{try{const s=await d.getUsers();f.value=s.data.data}catch(s){console.error(s)}},w=()=>{m.value="添加用户",o.value={username:"",password:"",email:"",role:"user"},r.value=!0},k=s=>{m.value="编辑用户",o.value={...s},r.value=!0},C=async()=>{try{o.value.id?await d.updateUser(o.value.id,o.value):await d.createUser(o.value),U.success("操作成功"),c(),r.value=!1}catch(s){console.error(s)}},x=async s=>{try{await d.deleteUser(s.id),U.success("删除成功"),c()}catch(e){console.error(e)}};return j(()=>{c()}),(s,e)=>{const B=n("t-icon"),_=n("t-button"),K=n("t-space"),N=n("t-table"),p=n("t-input"),u=n("t-form-item"),V=n("t-option"),M=n("t-select"),z=n("t-form"),A=n("t-dialog");return y(),D("div",P,[b("div",S,[e[6]||(e[6]=b("h1",null,"用户管理",-1)),t(_,{theme:"primary",onClick:w},{icon:l(()=>[t(B,{name:"add"})]),default:l(()=>[e[5]||(e[5]=v(" 添加用户 ",-1))]),_:1})]),t(N,{data:f.value,columns:g,style:{"margin-top":"16px"},stripe:"",hover:""},{operation:l(({row:a})=>[t(K,null,{default:l(()=>[t(_,{size:"small",onClick:T=>k(a)},{default:l(()=>[...e[7]||(e[7]=[v("编辑",-1)])]),_:1},8,["onClick"]),t(_,{size:"small",theme:"danger",onClick:T=>x(a)},{default:l(()=>[...e[8]||(e[8]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:1},8,["data"]),t(A,{visible:r.value,"onUpdate:visible":e[4]||(e[4]=a=>r.value=a),header:m.value,onConfirm:C},{default:l(()=>[t(z,{data:o.value},{default:l(()=>[t(u,{label:"用户名"},{default:l(()=>[t(p,{modelValue:o.value.username,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.username=a)},null,8,["modelValue"])]),_:1}),o.value.id?I("",!0):(y(),E(u,{key:0,label:"密码"},{default:l(()=>[t(p,{modelValue:o.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.password=a),type:"password"},null,8,["modelValue"])]),_:1})),t(u,{label:"邮箱"},{default:l(()=>[t(p,{modelValue:o.value.email,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.email=a)},null,8,["modelValue"])]),_:1}),t(u,{label:"角色"},{default:l(()=>[t(M,{modelValue:o.value.role,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.role=a)},{default:l(()=>[t(V,{value:"admin",label:"管理员"}),t(V,{value:"user",label:"普通用户"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1},8,["visible","header"])])}}},J=$(h,[["__scopeId","data-v-1ff844d0"]]);export{J as default};
