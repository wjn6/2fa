import{N as e,r as t,c as o,o as a,j as r,O as s,P as n,Q as c,b as i,R as l,G as d,S as u,U as m,V as p,W as g,X as h}from"./vendor-d600c78b.js";import{M as k,i as S}from"./ui-703c31fd.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const f=e("app",()=>{const e=t(localStorage.getItem("theme")||"light"),a=t(localStorage.getItem("language")||"zh-CN"),r=t(!0),s=t(localStorage.getItem("sessionToken")||""),n=t(!0),c=t(15),i=t(Date.now()),l=t(null),d=t(localStorage.getItem("authToken")||""),u=o(()=>"auto"===e.value?window.matchMedia("(prefers-color-scheme: dark)").matches:"dark"===e.value),m=o(()=>!!d.value),p=o(()=>!r.value&&!!s.value);function g(){const e=u.value;document.documentElement.classList.toggle("dark",e),document.documentElement.setAttribute("theme-mode",e?"dark":"light")}function h(){r.value=!0,s.value="",localStorage.removeItem("sessionToken")}function k(){i.value=Date.now()}return g(),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{"auto"===e.value&&g()}),{theme:e,language:a,isLocked:r,sessionToken:s,autoLockEnabled:n,autoLockTimeout:c,lastActivityTime:i,user:l,authToken:d,isDarkMode:u,isAuthenticated:m,isUnlocked:p,setTheme:function(t){e.value=t,localStorage.setItem("theme",t),g()},applyTheme:g,setLanguage:function(e){a.value=e,localStorage.setItem("language",e)},unlock:function(e){r.value=!1,s.value=e,localStorage.setItem("sessionToken",e),k()},lock:h,login:function(e,t){d.value=e,l.value=t,localStorage.setItem("authToken",e)},logout:function(){d.value="",l.value=null,localStorage.removeItem("authToken")},updateActivity:k,checkAutoLock:function(){if(!n.value||r.value)return;return Date.now()-i.value>60*c.value*1e3&&(h(),!0)}}});const v={__name:"App",setup(e){const t=f(),{startMonitoring:o}=function(){const e=f();let t=null,o=[];const s=()=>{e.updateActivity()},n=()=>{e.checkAutoLock()},c=()=>{["mousedown","keydown","scroll","touchstart"].forEach(e=>{document.addEventListener(e,s),o.push({event:e,handler:s})}),t=setInterval(n,6e4)},i=()=>{o.forEach(({event:e,handler:t})=>{document.removeEventListener(e,t)}),o=[],t&&(clearInterval(t),t=null)};return a(()=>{e.autoLockEnabled&&c()}),r(()=>{i()}),{startMonitoring:c,stopMonitoring:i}}();return a(()=>{t.applyTheme(),t.autoLockEnabled&&o()}),(e,o)=>{const a=s("router-view");return n(),c("div",{id:"app",class:l({dark:d(t).isDarkMode})},[i(a)],2)}}},y={},E=function(e,t,o){if(!t||0===t.length)return e();const a=document.getElementsByTagName("link");return Promise.all(t.map(e=>{if((e=function(e){return"/"+e}(e))in y)return;y[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(!!o)for(let o=a.length-1;o>=0;o--){const r=a[o];if(r.href===e&&(!t||"stylesheet"===r.rel))return}else if(document.querySelector(`link[href="${e}"]${r}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise((t,o)=>{s.addEventListener("load",t),s.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${e}`)))}):void 0})).then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e})},A=[{path:"/",name:"Home",component:()=>E(()=>import("./Home-549c3a69.js"),["assets/Home-549c3a69.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Home-491e3813.css"]),meta:{requiresUnlock:!0}},{path:"/unlock",name:"Unlock",component:()=>E(()=>import("./Unlock-f9b94e07.js"),["assets/Unlock-f9b94e07.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Unlock-ccda1425.css"])},{path:"/admin",name:"Admin",component:()=>E(()=>import("./Admin-f70f9fc8.js"),["assets/Admin-f70f9fc8.js","assets/vendor-d600c78b.js","assets/_plugin-vue_export-helper-1b428a4d.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/Admin-0d0eb5fd.css"]),meta:{requiresAuth:!0},children:[{path:"",redirect:"/admin/dashboard"},{path:"dashboard",name:"AdminDashboard",component:()=>E(()=>import("./Dashboard-02d14e1f.js"),["assets/Dashboard-02d14e1f.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/vendor-d600c78b.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Dashboard-dfba31d4.css"])},{path:"users",name:"AdminUsers",component:()=>E(()=>import("./Users-877706d6.js"),["assets/Users-877706d6.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/vendor-d600c78b.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Users-fe9652de.css"])},{path:"settings",name:"AdminSettings",component:()=>E(()=>import("./Settings-6d59f4ec.js"),["assets/Settings-6d59f4ec.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/vendor-d600c78b.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Settings-3b511426.css"])},{path:"logs",name:"AdminLogs",component:()=>E(()=>import("./Logs-2aa0be8a.js"),["assets/Logs-2aa0be8a.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/vendor-d600c78b.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Logs-ed6946ba.css"])}]},{path:"/login",name:"Login",component:()=>E(()=>import("./Login-428c88a8.js"),["assets/Login-428c88a8.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Login-dd2951d0.css"])},{path:"/register",name:"Register",component:()=>E(()=>import("./Register-b4a7029f.js"),["assets/Register-b4a7029f.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Register-257bc7b8.css"])},{path:"/settings",name:"Settings",component:()=>E(()=>import("./Settings-6f2b74ea.js"),["assets/Settings-6f2b74ea.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Settings-8d64d647.css"]),meta:{requiresUnlock:!0}},{path:"/api-keys",name:"ApiKeys",component:()=>E(()=>import("./ApiKeys-f8e2c797.js"),["assets/ApiKeys-f8e2c797.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/vendor-d600c78b.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/ApiKeys-7afc8c1a.css"]),meta:{requiresAuth:!0}},{path:"/theme",name:"ThemeCustom",component:()=>E(()=>import("./ThemeCustom-114a4277.js"),["assets/ThemeCustom-114a4277.js","assets/vendor-d600c78b.js","assets/_plugin-vue_export-helper-1b428a4d.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/ThemeCustom-7b87acc0.css"]),meta:{requiresUnlock:!0}},{path:"/profile",name:"Profile",component:()=>E(()=>import("./Profile-e4ca5394.js"),["assets/Profile-e4ca5394.js","assets/vendor-d600c78b.js","assets/index-42d0e3ec.js","assets/utils-783a0963.js","assets/ui-703c31fd.js","assets/ui-da465cc6.css","assets/_plugin-vue_export-helper-1b428a4d.js","assets/Profile-80b6708c.css"]),meta:{requiresAuth:!0}}],_=u({history:m(),routes:A});_.beforeEach((e,t,o)=>{var a,r;const s=f();document.title=e.meta.title?`${e.meta.title} - 2FA Notebook`:"2FA Notebook";const n=localStorage.getItem("token");if(n)try{const t=JSON.parse(atob(n.split(".")[1]));if(t.exp&&1e3*t.exp<Date.now()&&(localStorage.removeItem("token"),s.logout(),e.meta.requiresAuth))return k.warning("登录已过期，请重新登录"),void o("/login")}catch(c){}if("Login"!==e.name&&"Register"!==e.name||!s.isAuthenticated)return e.meta.requiresAuth&&!s.isAuthenticated?(k.warning("请先登录"),void o({path:"/login",query:{redirect:e.fullPath}})):e.meta.requiresAdmin&&"admin"!==(null==(r=s.user)?void 0:r.role)?(k.error("您没有权限访问此页面"),void o("/")):void(e.meta.requiresUnlock&&s.isLocked?o("/unlock"):"Unlock"!==e.name||s.isLocked?o():o("/"));o("admin"===(null==(a=s.user)?void 0:a.role)?"/admin":"/")}),_.onError(e=>{k.error("页面加载失败，请刷新重试")});const L={"zh-CN":{common:{confirm:"确定",cancel:"取消",save:"保存",delete:"删除",edit:"编辑",add:"添加",search:"搜索",export:"导出",import:"导入",close:"关闭",back:"返回",next:"下一步",prev:"上一步",loading:"加载中...",success:"成功",error:"错误",warning:"警告",info:"信息"},auth:{login:"登录",logout:"退出登录",username:"用户名",password:"密码",masterPassword:"主密码",unlock:"解锁",unlocking:"解锁中...",lock:"锁定",setMasterPassword:"设置主密码",changeMasterPassword:"修改主密码",passwordHint:"密码提示",enterPassword:"请输入密码",enterMasterPassword:"请输入主密码以解锁",passwordTooShort:"密码至少6位",unlockSuccess:"解锁成功",lockSuccess:"已锁定",autoLock:"自动锁定"},secret:{secrets:"密钥",secretName:"密钥名称",secretKey:"密钥",issuer:"发行者",category:"分类",note:"备注",icon:"图标",addSecret:"添加密钥",editSecret:"编辑密钥",deleteSecret:"删除密钥",copyToken:"复制验证码",copiedSuccess:"已复制到剪贴板",favorite:"收藏",pin:"置顶",tags:"标签",batchOperation:"批量操作",batchDelete:"批量删除",batchMove:"批量移动",batchExport:"批量导出",selectAll:"全选",unselectAll:"取消全选",selected:"已选择",batchMode:"批量模式",exitBatchMode:"退出批量",enterBatchMode:"批量",exportSelected:"导出选中",deleteSelected:"删除选中",selectedCount:"已选择 {count} 项",batchDeleteConfirm:"确定要删除选中的 {count} 个密钥吗？此操作不可恢复！",batchDeleteSuccess:"成功删除 {count} 个密钥",batchExportSuccess:"成功导出 {count} 个密钥",pleaseSelectFirst:"请先选择要操作的密钥"},category:{categories:"分类",categoryName:"分类名称",categoryDesc:"分类描述",addCategory:"添加分类",editCategory:"编辑分类",deleteCategory:"删除分类",allSecrets:"全部密钥",uncategorized:"未分类"},tag:{tags:"标签",tagName:"标签名称",tagColor:"标签颜色",addTag:"添加标签",editTag:"编辑标签",deleteTag:"删除标签"},backup:{backup:"备份",export:"导出数据",import:"导入数据",exportSuccess:"导出成功",importSuccess:"导入成功",autoBackup:"自动备份",backupHistory:"备份历史",encrypted:"加密",encryptedBackup:"加密备份",decryptPassword:"解密密码",merge:"合并模式",replace:"替换模式"},settings:{settings:"设置",theme:"主题",themeLight:"浅色",themeDark:"深色",themeAuto:"跟随系统",language:"语言",autoLock:"自动锁定",autoLockTimeout:"自动锁定时间",minutes:"分钟",autoBackup:"自动备份",backupInterval:"备份间隔",hours:"小时",usageStats:"使用统计"},admin:{admin:"后台管理",dashboard:"仪表盘",users:"用户管理",systemSettings:"系统设置",statistics:"统计信息",usageLogs:"使用日志",maintenance:"系统维护",addUser:"添加用户",editUser:"编辑用户",deleteUser:"删除用户",role:"角色",roleAdmin:"管理员",roleUser:"普通用户",active:"激活",inactive:"禁用",totalSecrets:"密钥总数",totalCategories:"分类总数",totalTags:"标签总数",totalUsers:"用户总数"},qrcode:{scanQRCode:"扫描二维码",uploadQRCode:"上传二维码",generateQRCode:"生成二维码",parseSuccess:"解析成功",parseFailed:"解析失败"},message:{deleteConfirm:"确定要删除吗？",deleteSuccess:"删除成功",saveSuccess:"保存成功",updateSuccess:"更新成功",operationSuccess:"操作成功",operationFailed:"操作失败",networkError:"网络错误",invalidFormat:"格式无效",required:"此项必填"}},"en-US":{common:{confirm:"Confirm",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",add:"Add",search:"Search",export:"Export",import:"Import",close:"Close",back:"Back",next:"Next",prev:"Previous",loading:"Loading...",success:"Success",error:"Error",warning:"Warning",info:"Info"},auth:{login:"Login",logout:"Logout",username:"Username",password:"Password",masterPassword:"Master Password",unlock:"Unlock",unlocking:"Unlocking...",lock:"Lock",setMasterPassword:"Set Master Password",changeMasterPassword:"Change Master Password",passwordHint:"Password Hint",enterPassword:"Enter password",enterMasterPassword:"Enter master password to unlock",passwordTooShort:"Password must be at least 6 characters",unlockSuccess:"Unlocked successfully",lockSuccess:"Locked",autoLock:"Auto Lock"},secret:{secrets:"Secrets",secretName:"Secret Name",secretKey:"Secret Key",issuer:"Issuer",category:"Category",note:"Note",icon:"Icon",addSecret:"Add Secret",editSecret:"Edit Secret",deleteSecret:"Delete Secret",copyToken:"Copy Token",copiedSuccess:"Copied to clipboard",favorite:"Favorite",pin:"Pin",tags:"Tags",batchOperation:"Batch Operation",batchDelete:"Batch Delete",batchMove:"Batch Move",batchExport:"Batch Export",selectAll:"Select All",unselectAll:"Unselect All",selected:"Selected",batchMode:"Batch Mode",exitBatchMode:"Exit Batch",enterBatchMode:"Batch",exportSelected:"Export Selected",deleteSelected:"Delete Selected",selectedCount:"{count} selected",batchDeleteConfirm:"Are you sure you want to delete {count} secrets? This action cannot be undone!",batchDeleteSuccess:"Successfully deleted {count} secrets",batchExportSuccess:"Successfully exported {count} secrets",pleaseSelectFirst:"Please select secrets first"},category:{categories:"Categories",categoryName:"Category Name",categoryDesc:"Category Description",addCategory:"Add Category",editCategory:"Edit Category",deleteCategory:"Delete Category",allSecrets:"All Secrets",uncategorized:"Uncategorized"},tag:{tags:"Tags",tagName:"Tag Name",tagColor:"Tag Color",addTag:"Add Tag",editTag:"Edit Tag",deleteTag:"Delete Tag"},backup:{backup:"Backup",export:"Export Data",import:"Import Data",exportSuccess:"Exported successfully",importSuccess:"Imported successfully",autoBackup:"Auto Backup",backupHistory:"Backup History",encrypted:"Encrypted",encryptedBackup:"Encrypted Backup",decryptPassword:"Decryption Password",merge:"Merge Mode",replace:"Replace Mode"},settings:{settings:"Settings",theme:"Theme",themeLight:"Light",themeDark:"Dark",themeAuto:"Auto",language:"Language",autoLock:"Auto Lock",autoLockTimeout:"Auto Lock Timeout",minutes:"minutes",autoBackup:"Auto Backup",backupInterval:"Backup Interval",hours:"hours",usageStats:"Usage Statistics"},admin:{admin:"Admin",dashboard:"Dashboard",users:"User Management",systemSettings:"System Settings",statistics:"Statistics",usageLogs:"Usage Logs",maintenance:"Maintenance",addUser:"Add User",editUser:"Edit User",deleteUser:"Delete User",role:"Role",roleAdmin:"Admin",roleUser:"User",active:"Active",inactive:"Inactive",totalSecrets:"Total Secrets",totalCategories:"Total Categories",totalTags:"Total Tags",totalUsers:"Total Users"},qrcode:{scanQRCode:"Scan QR Code",uploadQRCode:"Upload QR Code",generateQRCode:"Generate QR Code",parseSuccess:"Parsed successfully",parseFailed:"Parse failed"},message:{deleteConfirm:"Are you sure you want to delete?",deleteSuccess:"Deleted successfully",saveSuccess:"Saved successfully",updateSuccess:"Updated successfully",operationSuccess:"Operation successful",operationFailed:"Operation failed",networkError:"Network error",invalidFormat:"Invalid format",required:"This field is required"}}},w=p({legacy:!1,locale:localStorage.getItem("language")||"zh-CN",fallbackLocale:"zh-CN",messages:L});const T=g(v),b=h();T.config.errorHandler=(e,t,o)=>{},window.addEventListener("error",e=>{k.error("发生了一个错误，请刷新页面重试")}),window.addEventListener("unhandledrejection",e=>{k.error("操作失败，请重试")}),T.use(b),T.use(_),T.use(w),T.use(S),T.mount("#app");export{f as u};
